define("../../core/RC",[],function(){var e={};return e.touchable="ontouchend"in document,e.EVENT={TOUCH_START:"touchstart",TOUCH_MOVE:"touchmove",TOUCH_END:"touchend"},e.merge=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},e}),define("../../core/EventUtil",["../../core/RC"],function(){var e={touchable:"ontouchend"in document,TYPE:{TOUCH_START:"touchstart",TOUCH_MOVE:"touchmove",TOUCH_END:"touchend"},addEventListener:function(e,t,n,i){e.addEventListener?e.addEventListener(t,n,i):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n},removeEventListener:function(e,t,n){e.removeEventListener?e.removeEventListener(t,n):e.detacjEvent?e.detacjEvent("on"+t,n):e["on"+t]=null},fixEvent:function(e){e=e||window.event},getTarget:function(e){return e.target||e.srcElement}};return e}),define("core/Slide",["../../core/RC","../../core/EventUtil"],function(e,t){return e.Slide=function(t){var n=this;n.isSlide=!1,n.touchIdentifier=null,n.opt=e.merge({elemQuery:"body",slideEnd:null,slideBegin:null,slideMove:null},t),this.elems=[].slice.call(document.querySelectorAll(n.opt.elemQuery)),n.startHandler=function(){return n.StartHandler.apply(n,arguments)},n.moveHandler=function(){return n.MoveHandler.apply(n,arguments)},n.endHandler=function(){return n.EndHandler.apply(n,arguments)},this.addHandlers()},e.Slide.prototype.addHandlers=function(){var e=this;e.elems.forEach(function(n){n.addEventListener(t.TYPE.TOUCH_START,e.startHandler),n.addEventListener(t.TYPE.TOUCH_MOVE,e.moveHandler),n.addEventListener(t.TYPE.TOUCH_END,e.endHandler)})},e.Slide.prototype.removeHandlers=function(){var e=this;this.elems.forEach(function(n){n.removeEventListener(t.TYPE.TOUCH_START,e.startHandler,!1),n.removeEventListener(t.TYPE.TOUCH_MOVE,e.moveHandler,!1),n.removeEventListener(t.TYPE.TOUCH_END,e.endHandler,!1)})},e.Slide.prototype.StartHandler=function(t){t.preventDefault();var n=this,i=t.touches;null==this.touchIdentifier?this.touchIdentifier=i[0].identifier:[].slice.apply(i).forEach(function(){}),t.touches.length>1||this.isSlide===!1&&(this.isSlide=!0,"function"==typeof this.opt.slideBegin&&n.opt.slideBegin.call(n,e.merge({},i[0])))},e.Slide.prototype.MoveHandler=function(t){var n=this;t.preventDefault();var i=t.targetTouches.length?t.targetTouches:t.changedTouches;(n.isSlide=!0)&&[].slice.apply(i).forEach(function(t){t.identifier==n.touchIdentifier&&"function"==typeof n.opt.slideMove&&n.opt.slideMove.call(n,e.merge({},t))})},e.Slide.prototype.EndHandler=function(t){var n=this;t.preventDefault();var i=t.changedTouches;n.isSlide===!0&&[].slice.apply(i).forEach(function(t){if(t.identifier==n.touchIdentifier&&(n.isSlide=!1,n.touchIdentifier=null,"function"==typeof n.opt.slideEnd)){var i=n.opt.slideEnd.call(n,e.merge({},t));1==i&&n.cancel()}})},e.Slide}),define("util/MathUtil",[],function(){var e={getAngle:function(e,t,n,i){var o=Math.abs(e-n),r=Math.abs(t-i),a=Math.sqrt(Math.pow(o,2)+Math.pow(r,2)),c=o/a,l=Math.acos(c),s=180/(Math.PI/l);return s},getAngleDirect:function(t,n){var i=n.pageX-t.pageX,o=n.pageY-t.pageY,r=e.getAngle(n.pageX,n.pageY,t.pageX,t.pageY);return o>0?r=i>0?360-r:180+r:i>0||(r=180-r),r}};return e}),define("util/ElemUtil",[],function(){var e={query:function(e){var t=null;return document.querySelector&&(t=document.querySelector),t.call(document,e)},queryAll:function(e){var t=null;return document.querySelectorAll&&(t=document.querySelectorAll),t.call(document,e)}};return e}),define("ft/Game",[],function(){function e(){this.canvasElem=document.getElementById("gameScreen"),this.ctx=this.canvasElem.getContext("2d"),this.init()}var t,n=new Image;n.src="images/arrow.png";var i=[];return e.prototype.init=function(){this.resize(),this.draw()},e.prototype.clear=function(){this.draw()},e.prototype.draw=function(){var e,n,i=288/455,o=this.ctx.width/this.ctx.height;o>i?(e=this.ctx.height*i,n=this.ctx.height):(e=this.ctx.width,n=this.ctx.width/i),this.ctx.fillStyle="#fff",this.ctx.fillRect(0,0,this.canvasElem.width,this.canvasElem.height),t||(t=new Image,t.src="images/tfz.jpg",t.onload=function(){})},e.prototype.drawArrow=function(e,t,i,o){if(this.clear(),this.draw(),0!=t){var r=i,a=o,c=r,l=a;this.ctx.save(),this.ctx.translate(c,l),this.ctx.rotate(e*Math.PI/180),this.ctx.drawImage(n,0,-10,t,20),this.ctx.translate(-c,-l),this.ctx.restore()}},e.prototype.drawTrack=function(t,n,i,o,r){e.CanvasHelper.drawTrack(this.ctx,r,t,n,i,o,"#c00")},e.prototype.resize=function(){this.canvasElem.width=$(window).width(),this.canvasElem.height=$(window).height()-150,this.ctx.width=$(window).width(),this.ctx.height=$(window).height()-150},e.prototype.record=function(e,t,n){t&&(i[i.length]={color:"#c00",radius:n,pointList:[]}),e&&i[i.length-1].pointList.push(e)},e.prototype.clearRecord=function(){i=[]},e.prototype.undo=function(){this.clear(),this.draw();var e=0;for(i.pop();e<i.length;)this.reDraw(i[e]),e++},e.prototype.reDraw=function(t){for(var n=t.radius,i=t.color,o=1,r=t.pointList;o<r.length;){var a=r[o-1],c=r[o];e.CanvasHelper.drawTrack(this.ctx,n,a.pageX,a.pageY,c.pageX,c.pageY,i),o++}},e.CanvasHelper={fillCircle:function(e,t,n,i,o){e.fillStyle=o,e.beginPath(),e.arc(t,n,i,0,2*Math.PI,!0),e.closePath(),e.fill()},drawTrack:function(e,t,n,i,o,r,a){e.lineJoin="round",e.lineCap="round",e.beginPath(),e.lineWidth=""+t,e.strokeStyle=a,i-=50,r-=50,e.moveTo(n,i),e.lineTo(o,r),e.stroke()}},e}),define("src/ScratchGame",["ft/Game"],function(Game){function ScratchGame(e){console.log("init ScratchGame"),Game.apply(this,[e]),this.canvasElem.style.backgroundSize="cover",this.canvasElem.style.backgroundPosition="center"}var bgImg=new Image;return ScratchGame.prototype=new Game,ScratchGame.prototype.constructor=ScratchGame,ScratchGame.prototype.draw=function(){var e=this;e.ctx.fillStyle="#333",e.ctx.fillRect(0,0,e.canvasElem.width,e.canvasElem.height),bgImg.onload=function(){console.log(bgImg),e.ctx.drawImage(bgImg,0,0,e.canvasElem.width,e.canvasElem.height)},bgImg.src="../images/canvas.jpg"},Game.prototype.resize=function(){console.log("resize"),this.canvasElem.width=$(window).width(),this.canvasElem.height=$(window).height(),this.ctx.width=$(window).width(),this.ctx.height=$(window).height()},ScratchGame.prototype.scratch=function(e,t,n,i,o){this.ctx.globalCompositeOperation="destination-out",this.ctx.lineJoin="round",this.ctx.lineCap="round",this.ctx.beginPath(),ctx.lineWidth=o,t=t,i=i,this.ctx.moveTo(e,t),this.ctx.lineTo(n,i),this.ctx.stroke()},ScratchGame.prototype.scratchArc=function(x,y,r){with(x-=this.canvasElem.offsetLeft,y-=this.canvasElem.offsetTop,this.ctx)beginPath(),arc(x,y,r/2,0,2*Math.PI),fill()},ScratchGame}),define("dist/main-scratch",["core/Slide","util/MathUtil","util/ElemUtil","src/ScratchGame"],function(e,t,n,i){function o(){console.log("start init");try{r=new i(h),$(".sl-slider").height($(window).height())}catch(e){console.log("init error"),console.log(e)}}var r,a=null,c=null,l=null,s=30,h="gameScreen",d=document.getElementById(h),u=d.getContext("2d"),f=0;window.ctx=u;o();new e({elemQuery:"#gameScreen",slideBegin:function(e){f++;try{l=a=e,console.log(r),r.record(e,!0,s),r.scratchArc(a.pageX,a.pageY,s)}catch(t){console.log("begin error: "+t.message)}},slideMove:function(e){f++;try{c=e,r.scratch(l.pageX,l.pageY,c.pageX,c.pageY,s),r.record(e)}catch(t){console.log("move error: "+t.message)}l=e},slideEnd:function(){try{a=l=c=null,f>100&&(document.getElementById(h).style.display="none",$(".jt_left").show()),console.log(this),r.record()}catch(e){console.log("end error: "+e.message)}}});return WeixinApi.ready(function(e){var t={imgUrl:"http://www.helloweba.com/demo/guaguaka/p_1.jpg",link:window.location.href,desc:"刮刮卡",title:"刮刮卡"},n={ready:function(){},cancel:function(){},fail:function(){},confirm:function(){},all:function(){}};e.shareToFriend(t,n),e.shareToTimeline(t,n),e.shareToWeibo(t,n)}),{}});